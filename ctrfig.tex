% Copyright 2021 Google LLC
%
% Use of this source code is governed by an MIT-style
% license that can be found in the LICENSE file or at
% https://opensource.org/licenses/MIT.
\begin{tikzpicture}
	[line width=0.6,
		box/.style = {
			draw, rectangle, rounded corners
		},
		wire/.style = {
			->,rounded corners=1.5pt
		},
		minimum size=0.5cm,
		x=1.5cm, y=1.5cm
	]
	%Draw nodes
	\node[rectangle] at (0,0) (S1) {$S \oplus 1$};
	\node[rectangle] at (1,0) (S2) {$S \oplus 2$};
	\node[rectangle] at (2,0) (S3) {$S \oplus 3$};
	\node[rectangle] at (2.5,0) (S5) {$\cdots$};

	\node[rectangle] at (0,-1) (E1) {$Enc_K$};
	\node[rectangle] at (1,-1) (E2) {$Enc_K$};
	\node[rectangle] at (2,-1) (E3) {$Enc_K$};
	\node[rectangle] at (2.5,-1) (E5) {$\cdots$};

	\node[rectangle] at (-0.5,-2) (P0) {$P_0$};
	\node[rectangle] at (0.5,-2) (P1) {$P_1$};
	\node[rectangle] at (1.5,-2) (P2) {$P_2$};

	\node[XOR] at (0, -2) (X1) {};
	\node[XOR] at (1, -2) (X2) {};
	\node[XOR] at (2, -2) (X3) {};
	\node[rectangle] at (2.5, -2) (X5) {$\cdots$};

	\node[rectangle] at (0,-3) (C0) {$C_0$};
	\node[rectangle] at (1,-3) (C1) {$C_1$};
	\node[rectangle] at (2,-3) (C2) {$C_2$};
	\node[rectangle] at (2.5,-3) (C4) {$\cdots$};

	\draw[wire] (S1) -- (E1) -- (X1) -- (C0);
	\draw[wire] (P0) -- (X1);
	\draw[wire] (S2) -- (E2) -- (X2) -- (C1);
	\draw[wire] (P1) -- (X2);
	\draw[wire] (S3) -- (E3) -- (X3) -- (C2);
	\draw[wire] (P2) -- (X3);
\end{tikzpicture}

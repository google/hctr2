% Copyright 2021 Google LLC
%
% Use of this source code is governed by an MIT-style
% license that can be found in the LICENSE file or at
% https://opensource.org/licenses/MIT.

%!BIB program = biber
%!TeX program = lualatex
%!TeX spellcheck = en-US

\documentclass[hctr.tex]{subfiles}
\begin{document}
\begin{figure}
    \begin{floatrow}
        \ffigbox{
            \begin{algorithmic}[0]
                \Procedure{\(HCTR2_{k, T}\)}{$P$}
                \State $h \gets E_k(\fromint(0))$
                \State $L \gets E_k(\fromint(1))$
                \State $M \Concat N \gets P$, $|M| = n$
                \State $\MM \gets M \xor H_h(T, N)$
                \State $\UU \gets E_k(\MM)$
                \State $S \gets \MM \xor \UU \xor L$
                \State $V \gets N \xor \XCTR_k(S)[0;\abs{N}]$
                \State $U \gets \UU \xor H_h(T, V)$
                \State $C \gets U \Concat V$
                \State \textbf{return} $C$
                \EndProcedure
            \end{algorithmic}
        }{
            \caption{HCTR2 encryption}\label{pseudocode}
        }
        \ffigbox{
            \begin{algorithmic}[0]
                \Procedure{\(HCTR2_{k, T}^{-1}\)}{$C$}
                \State $h \gets E_k(\fromint(0))$
                \State $L \gets E_k(\fromint(1))$
                \State $U \Concat V \gets C$, $|U| = n$
                \State $\UU \gets U \xor H_h(T, V)$
                \State $\MM \gets E_k^{-1}(\UU)$
                \State $S \gets \MM \xor \UU \xor L$
                \State $N \gets V \xor \XCTR_k(S)[0;\abs{V}]$
                \State $M \gets \MM \xor H_h(T, N)$
                \State $P \gets M \Concat N$
                \State \textbf{return} $P$
                \EndProcedure
            \end{algorithmic}
        }{
            \caption{HCTR2 decryption}
        }
    \end{floatrow}
\end{figure}
\end{document}

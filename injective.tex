% Copyright 2021 Google LLC
%
% Use of this source code is governed by an MIT-style
% license that can be found in the LICENSE file or at
% https://opensource.org/licenses/MIT.

%!BIB program = biber
%!TeX program = lualatex
%!TeX spellcheck = en-US

\documentclass[hctr.tex]{subfiles}
\begin{document}
\section{Injectivity of H onto polynomials}\label{injective}
To demonstrate injectivity, 
the following algorithm recovers \(T\) and \(M\) given
the polynomial \(H(T, M)\).
Assume \(\coeff(p, i)\) returns the binary form of the \(i\)'th
coefficient of \(p\), and \(\lambda\) represents the empty string:
\begin{algorithmic}[0]
    \Procedure{GetTM}{$p$}
    \State \(d \gets \deg(p)\)
    \State \textbf{assert} \(d \geq 1\)
    \State \textbf{assert} \(\coeff(p, 0) = 0^n\)
    \State \(X \gets \coeff(p, d)\)
    \State \(m \gets X[0; 1]\)
    \State \(t \gets \fromint^{-1}_{n-1}(X[1;n-1])\)
    \State \textbf{assert} \(t > 0\)
    \State \(t \gets t-1\)
    \State \(T \gets \lambda\)
    \While{\(t \geq n\)}
        \State \textbf{assert} \(d > 1\)
        \State \(d \gets d-1\)
        \State \(T \gets T \Concat \coeff(p, d)\)
        \State \(t \gets t - n\)
    \EndWhile
    \If{\(t > 0\)}
        \State \textbf{assert} \(d > 1\)
        \State \(d \gets d-1\)
        \State \(T \gets T \Concat \coeff(p, d)[0;t]\)
    \EndIf
    \State \(M \gets \lambda\)
    \If{\(m = 0\)}
        \While{\(d > 1\)}
            \State \(d \gets d-1\)
            \State \(M \gets M \Concat \coeff(p, d)\)
        \EndWhile
    \Else
        \State \textbf{assert} \(d > 1\)
        \While{\(d > 2\)}
            \State \(d \gets d-1\)
            \State \(M \gets M \Concat \coeff(p, d)\)
        \EndWhile
        \State \(d \gets d-1\)
        \State \(X \gets \coeff(p, d)\)
        \State \textbf{assert} \(X \neq 0^n\)
        \For{\(i \gets (n-1, n-2, \ldots, 1, 0)\)}
            \If{\(X[i;1] = 1\)}
                \State \textbf{break}
            \EndIf
        \EndFor
        \State \textbf{assert} \(i > 0\)
        \State \(M \gets M \Concat X[0;i]\)
    \EndIf
    \State \textbf{return} \(T, M\)
    \EndProcedure
\end{algorithmic}

\end{document}
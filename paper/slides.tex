\documentclass{beamer}

\usepackage{tikz}
\usepackage[logic,probability,advantage,adversary,landau,sets,operators]{cryptocode}

\usetikzlibrary{groupops}

\input{defines.tex}

\setbeamertemplate{navigation symbols}{}

\title{HCTR2}
\author{Paul Crowley, Eric Biggers, Nathan Huckleberry}
\institute{Google LLC}
\date{2023-10-03}

\usepackage{subfiles}
\begin{document}

\frame{\titlepage}

\begin{frame}

\frametitle{Background}

\begin{itemize}
    \item Adiantum for disk encryption on low-end
    \item needed a wide-block mode efficient on small blocks
    \item fast with AES+GCM instructions
\end{itemize}
\end{frame}

\begin{frame}

\frametitle{The field}

\begin{itemize}
    \item Much interest in wide block modes around 2005--2009
    \item Many proposals: CMC, EME, EME*, PEP, TET, HEH, HCH, HSE, HMC\ldots
    \item We chose HCTR (Wang, Feng, and Wu 2005)
\end{itemize}
\end{frame}

\begin{frame}

\frametitle{Hash-encrypt-hash}

\begin{itemize}
    \item Any secure wide-block mode has three passes
    \item Almost-universal hashing is faster than encryption
    \item so hash-encrypt-hash is fastest
    \item HHFHFH is hash-encrypt-hash in disguise
\end{itemize}
\end{frame}

\begin{frame}

\frametitle{HCTR}

\begin{itemize}
    \item Simple
    \item fast with AES+GHASH instructions
    \item No ciphertext stealing tricks needed
    \item XCTR mode
    \item tight quadratic security claim
\end{itemize}
\end{frame}

\begin{frame}

    \frametitle{XCTR mode}
    
    \begin{itemize}
        \item CTR: nonce PLUS counter
        \item XCTR: nonce XOR counter
        \item No 128-bit addition required
        \item No nasty GCM hack
    \end{itemize}
\end{frame}

\begin{frame}

\frametitle{HCTR issues}

\begin{itemize}
    \item Block-length message special case
    \item \ldots makes hash non injective
    \item Error in quadratic security proof
    \item HCTR2 fixes these, and ``sands the edges''
\end{itemize}
\end{frame}

\begin{frame}

\frametitle{HCTR2}
\begin{figure}
\subfile{hctr2fig.tex}
\end{figure}
\begin{itemize}
    \item $L$ fixes quadratic security proof
\end{itemize}

\end{frame}

\begin{frame}

\frametitle{HCTR2 hash function}

\begin{itemize}
    \item Fixes the zero bug
    \item Handles variable-length tweak
    \item Tweak+length block processed only once
    \item uses POLYVAL for speed
\end{itemize}
\end{frame}

\begin{frame}

\frametitle{Sanding the edges}

\begin{itemize}
    \item $h$, $L$ derived from block cipher
    \item Endianness etc specified
    \item Sample implementation and test vectors
    \item In Linux kernel now
\end{itemize}
\end{frame}

\begin{frame}

    \frametitle{Quadratic security}

    \begin{align*}
        &\advantage{\pm \widetilde{\mathrm{prp}}}{\HCTR[E]}[(q, \sigma, t)] \\
        \leq & \quad \advantage{\pm \mathrm{prp}}{E}[(\sigma + 2, t + \sigma t')] \\
        &+ \left.\left(3\sigma^2 + 2q\sigma + q^2 + 7\sigma + 2\right)\middle/2^{n+1}\right.
    \end{align*}
        

    \begin{itemize}
        \item \(q\) queries, \(\sigma\) blocks, \(t\) time
    \end{itemize}
\end{frame}
    
\begin{frame}
\frametitle{Speculative bit: better than quadratic security}

\begin{itemize}
    \item Inspired by AES-GCM-SIV
    \item Per-message keys derived from nonce
    \item Derive $h$ and $L$ in the same way
    \item Multi-target security matters if keys are 128-bit
    \item Proof in ideal cipher model
\end{itemize}
\end{frame}

\end{document}